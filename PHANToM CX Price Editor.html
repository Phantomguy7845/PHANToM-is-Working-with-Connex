<!DOCTYPE html><html lang="th"><head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ตัวช่วยจัดสคริปต์แก้ไขประกาศ (Copy to Clipboard + ประวัติ)</title>
<style>
  :root{
    --bg:#0b1220; --card:#101a33; --ink:#e7ecf5; --muted:#9db0d6; --pri:#4f76ff; --ok:#22c55e; --warn:#f59e0b; --err:#ef4444; --line:#1e2b4d;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 800px at 10% 10%,#0f1426,#080c17 60%),linear-gradient(#0a1222,#0b1220);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,'Prompt',sans-serif;display:flex;justify-content:center;align-items:flex-start;padding:24px}
  .app{width:min(1100px,96vw)}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
  .title{font-weight:800;letter-spacing:.3px}
  .title small{display:block;color:var(--muted);font-weight:500}
  .grid{display:grid;grid-template-columns:1.2fr 1fr;gap:16px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 4px 24px rgba(0,0,0,.25)}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  label{font-size:.9rem;color:var(--muted)}
  input[type="text"], select, input[type="search"]{width:100%;padding:12px 14px;border:1px solid var(--line);background:#0d1530;color:var(--ink);border-radius:12px;outline:0;transition:border .15s, transform .05s}
  input:focus, select:focus{border-color:var(--pri);box-shadow:0 0 0 3px rgba(79,118,255,.15)}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  button{appearance:none;border:1px solid transparent;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;transition:transform .06s ease, filter .2s ease, background .2s ease, border .2s ease}
  button:active{transform:translateY(1px)}
  .btn{background:var(--pri);color:white}
  .btn.secondary{background:#132044;border-color:var(--line)}
  .btn.ghost{background:transparent;border-color:var(--line);color:var(--ink)}
  .btn.warn{background:var(--warn);color:black}
  .btn.danger{background:var(--err)}
  .mono{font-family:ui-monospace,Menlo,Consolas,monospace}
  .latest{white-space:pre-wrap;background:#0c1531;border-radius:12px;border:1px dashed #2b3a66;padding:12px}
  .list{display:flex;flex-direction:column;gap:10px;max-height:480px;overflow:auto;margin-top:8px}
  .item{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:10px;padding:10px;border:1px solid var(--line);border-radius:12px;background:#0c1531}
  .item .meta{font-size:.8rem;color:var(--muted)}
  .item .name{font-weight:700}
  .item .ops{display:flex;gap:8px}
  .toast{position:fixed;right:16px;bottom:16px;background:#0d1b36;border:1px solid var(--line);padding:12px 14px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.35);opacity:0;transform:translateY(10px);pointer-events:none;transition:opacity .2s, transform .2s}
  .toast.show{opacity:1;transform:translateY(0)}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="title">
      <div style="font-size:1.35rem">ตัวช่วยจัดสคริปต์แก้ไขประกาศ</div>
      <small>กรอกข้อมูลแล้วกด Enter เพื่อสร้างสคริปต์และคัดลอกอัตโนมัติ</small>
    </div>
  </header>
  <div class="grid">
    <section class="card">
      <h3>กรอกข้อมูล</h3>
      <div class="row">
        <div>
          <label for="code">รหัสทรัพย์</label>
          <input id="code" type="text" placeholder="CX-135467 หรือ 135467" />
        </div>
        <div>
          <label for="project">โครงการ</label>
          <input id="project" type="text" placeholder="ชื่อโครงการ" />
        </div>
      </div>
      <div class="row">
        <div>
          <label for="oldp">ราคาเดิม</label>
          <input id="oldp" type="text" placeholder="ตัวเลขหรือหน่วย (K, Thousand, M, Million)" />
        </div>
        <div>
          <label for="newp">ราคาใหม่</label>
          <input id="newp" type="text" placeholder="ตัวเลขหรือหน่วย (K, Thousand, M, Million)" />
        </div>
      </div>
      <div>
        <label for="type">ประเภทการแก้ไขราคา</label>
        <select id="type">
          <option value="เช่า">ปรับราคาเช่า</option>
          <option value="ขาย">ปรับราคาขาย</option>
        </select>
      </div>
      <div class="actions">
        <button id="submit" class="btn">สร้างสคริปต์ (Enter)</button>
      </div>
      <pre id="latest" class="latest mono">—</pre>
    </section><section class="card">
  <h3>ประวัติ</h3>
  <div id="history" class="list"></div>
</section>

  </div>
  <div id="toast" class="toast">คัดลอกแล้ว</div>
</div>
<script>
(function(){
  const $ = s=>document.querySelector(s);
  const $$ = s=>Array.from(document.querySelectorAll(s));
  const LS_KEY='scriptHistoryV2';
  const f=(v)=>{if(!v)return v;v=v.trim();v=v.replace(/\s+/g,'');v=v.replace(/,/g,'');v=v.replace(/([kKmM].*)/,'$1');if(/^\d{1,3}$/.test(v))return v+'K';if(/k$/i.test(v))return v.toUpperCase();if(/thousand$/i.test(v))return v.replace(/thousand/i,'K');if(/million$/i.test(v))return v.replace(/million/i,'M').toUpperCase();return v;};
  const formatCode=c=>{c=c.trim().toUpperCase();if(/^CX-/.test(c))return c; if(/^\d+$/.test(c))return 'CX-'+c; if(/^CX\d+$/.test(c))return c.replace('CX','CX-'); return c;};
  const makeScript=o=>`แก้ไขข้อมูลประกาศ\nรหัสทรัพย์ : ${formatCode(o.code)}\nโครงการ : ${o.project}\nข้อมูลที่ต้องการให้แก้ไขคือ :\n${o.type}จาก ${f(o.oldp)} เป็น ${f(o.newp)}`;
  const read=()=>JSON.parse(localStorage.getItem(LS_KEY)||'[]');
  const write=d=>localStorage.setItem(LS_KEY,JSON.stringify(d));
  const render=()=>{const list=$('#history');list.innerHTML='';read().forEach((x,i)=>{const div=document.createElement('div');div.className='item';div.innerHTML=`<div><div class='name'>${x.code} · ${x.project}</div><div class='meta'>${x.type} ${f(x.oldp)}→${f(x.newp)}</div></div><div class='ops'><button class='btn secondary' data-i='${i}'>คัดลอก</button><button class='btn ghost' data-d='${i}'>ลบ</button></div>`;list.appendChild(div);});$$('button[data-i]').forEach(b=>b.onclick=()=>copy(read()[b.dataset.i].text));$$('button[data-d]').forEach(b=>b.onclick=()=>{let d=read();d.splice(b.dataset.d,1);write(d);render();});};
  const toast=m=>{const t=$('#toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1200);};
  const copy=async t=>{try{await navigator.clipboard.writeText(t);toast('คัดลอกแล้ว');}catch(e){alert('คัดลอกไม่สำเร็จ');}};
  const sub=()=>{const code=$('#code').value,proj=$('#project').value,oldp=$('#oldp').value,newp=$('#newp').value,type=$('#type').value;if(!code||!proj||!oldp||!newp)return toast('กรอกข้อมูลให้ครบ');const text=makeScript({code,project:proj,oldp,newp,type});$('#latest').textContent=text;copy(text);let d=read();d.unshift({code:formatCode(code),project:proj,oldp,newp,type,text});write(d);render();$('#code').value=$('#project').value=$('#oldp').value=$('#newp').value='';$('#code').focus();};
  $('#submit').onclick=sub;document.addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault();sub();}});render();})();
</script>
</body></html>
