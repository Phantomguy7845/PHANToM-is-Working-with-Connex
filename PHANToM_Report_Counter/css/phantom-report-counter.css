:root {
  --bg-dark: #0a0f1f;
  --bg-panel-dark: #101b32;
  --text-dark: #e5e7eb;
  --muted-dark: #a0aec0;

  --bg-light: #f3f6fc;
  --bg-panel-light: #ffffff;
  --text-light: #1e293b;
  --muted-light: #6b7280;

  --aurora1: #6b8bff;
  --aurora2: #8bf5ff;
  --aurora3: #a76bff;
  --ok: #22c55e;
  --warn: #f59e0b;
  --danger: #ef4444;
}

[data-theme="dark"] {
  --bg: var(--bg-dark);
  --bg-panel: var(--bg-panel-dark);
  --text: var(--text-dark);
  --muted: var(--muted-dark);
}
[data-theme="light"] {
  --bg: var(--bg-light);
  --bg-panel: var(--bg-panel-light);
  --text: var(--text-light);
  --muted: var(--muted-light);
}

/* Base */
* { box-sizing: border-box; transition: background .25s ease, color .25s ease, border .25s ease; }
body{
  margin:0; min-height:100vh; background:radial-gradient(circle at 20% 20%,var(--bg-panel),var(--bg));
  font-family:"Prompt",system-ui,sans-serif; color:var(--text); display:flex; flex-direction:column;
}
h3{ margin-top:0; font-weight:800 }

/* Topbar */
.topbar{
  display:flex; justify-content:space-between; align-items:center; padding:10px 16px;
  background:var(--bg-panel); border-bottom:1px solid rgba(255,255,255,.08); box-shadow:0 2px 12px rgba(0,0,0,.3); position:sticky; top:0; z-index:20;
}
.brand{ display:flex; flex-direction:column; gap:2px }
.brand .logo{
  font-size:1.3rem; font-weight:800; letter-spacing:1px;
  background:linear-gradient(90deg,var(--aurora1),var(--aurora3),var(--aurora2)); -webkit-background-clip:text; color:transparent;
}
.brand small{ font-size:.8rem; color:var(--muted) }
.actions{ display:flex; align-items:center; flex-wrap:wrap; gap:6px }
input[type="text"], input[type="date"], select{
  padding:6px 8px; border-radius:8px; border:1px solid rgba(255,255,255,.1);
  background:rgba(255,255,255,.05); color:var(--text); outline:none;
}
[data-theme="light"] input, [data-theme="light"] select{ background:#f8f9ff; color:#111; border-color:#cbd5e1 }
input::placeholder{ color:var(--muted) }

/* Buttons */
.btn{
  padding:6px 12px; border-radius:10px; border:1px solid transparent; font-weight:700; cursor:pointer;
  background:linear-gradient(90deg,var(--aurora1),var(--aurora3),var(--aurora2)); color:#000;
  background-size:300% 300%; animation:aurora 8s ease infinite alternate;
}
.btn:hover{ filter:brightness(1.08) }
.btn.ok{ background:var(--ok); color:#fff }
.btn.warn{ background:var(--warn); color:#000 }
.btn.danger{ background:var(--danger); color:#fff }
.btn.ghost{ background:transparent; border:1px solid rgba(255,255,255,.2); color:var(--text) }
.btn.ghost:hover{ border-color:var(--aurora2); color:var(--aurora2) }
.import-label{ position:relative; overflow:hidden }
.import-label input{ position:absolute; inset:0; opacity:0; cursor:pointer }

/* Layout */
.wrap{ flex:1; display:grid; grid-template-columns:300px 1fr; gap:12px; padding:12px }
@media (max-width: 900px){ .wrap{ grid-template-columns:1fr } }

.panel.card, .board.card{
  background:var(--bg-panel); border:1px solid rgba(255,255,255,.1);
  border-radius:14px; padding:14px; box-shadow:0 8px 24px rgba(0,0,0,.25); backdrop-filter:blur(6px);
}
.row{ display:grid; grid-template-columns:1fr auto; gap:8px }

.help-block summary{ font-weight:700; cursor:pointer }
.help-block ul{ margin:8px 0 0 12px; padding-left:0; font-size:.9rem; list-style-type:"â€¢ "; color:var(--muted) }

/* Summary bar */
.summary-bar{
  background:rgba(255,255,255,.05); border-radius:10px; padding:8px 12px; margin-bottom:10px;
  font-size:.95rem; color:var(--aurora2); text-align:center;
}

/* Tree */
.tree{ display:flex; flex-direction:column; gap:8px; padding:6px; outline:none; height:calc(100vh - 220px); overflow-y:auto; scrollbar-width:thin }
.node{ border:1px solid rgba(255,255,255,.1); border-radius:10px; padding:10px; background:rgba(255,255,255,.03); transition:all .2s ease }
.node.selected{ border-color:var(--aurora2); box-shadow:0 0 10px var(--aurora2) }
.node .header, .sub-header{ display:flex; justify-content:space-between; align-items:center; gap:10px }
.node .title{ font-weight:700; font-size:1rem }
.node .mtype{ font-size:.8rem; color:var(--muted) }
.node .countWrap{ display:flex; align-items:center; gap:6px }
.node .count{
  padding:4px 8px; background:rgba(255,255,255,.1); border-radius:6px; min-width:42px; text-align:center; cursor:pointer; font-weight:800;
}
.node input[type="number"]{ width:80px; padding:4px 6px; border-radius:6px; border:1px solid rgba(255,255,255,.15); background:rgba(255,255,255,.07); color:var(--text) }
.node textarea.textbox{
  width:100%; min-height:72px; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1);
  color:var(--text); border-radius:10px; padding:10px; resize:vertical; outline:none; font-family:inherit; font-size:.95rem;
}
.node textarea.textbox:focus{ border-color:var(--aurora2); box-shadow:0 0 6px var(--aurora2) }
.node .ops{ display:flex; align-items:center; gap:4px }
.node .ops button{ padding:2px 8px; font-size:.85rem }

/* Toggle */
.toggle{ display:inline-flex; gap:6px; align-items:center; color:var(--muted); font-size:.9rem }

/* Modal */
.modal::backdrop{ background:rgba(0,0,0,.5); backdrop-filter:blur(2px) }
.modal-card{
  background:var(--bg-panel); color:var(--text); padding:12px; border-radius:14px; max-width:700px; width:92%;
  border:1px solid rgba(255,255,255,.12);
}
.modal-head{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px }
.modal-body{ max-height:60vh; overflow-y:auto }
.sum-help{ color:var(--muted); font-size:.95rem; margin-bottom:10px }
.sum-row{ display:flex; align-items:center; gap:6px; margin-bottom:4px }
.sum-row input{ flex:1 }
.sum-list{ display:flex; flex-direction:column; gap:10px; margin-bottom:10px }
.sum-item{ padding:8px; border:1px solid rgba(255,255,255,.1); border-radius:10px; background:rgba(255,255,255,.03) }
.sum-sources{ display:flex; flex-wrap:wrap; gap:8px; margin-top:6px }
.sum-tag{ font-size:.85rem; color:var(--muted) }
.sum-tag input{ margin-right:4px }

/* Toast */
.toast{
  position:fixed; right:14px; bottom:14px; background:#0d1b36; color:#fff; padding:10px 12px; border-radius:10px;
  border:1px solid rgba(255,255,255,.15); box-shadow:0 2px 10px rgba(0,0,0,.3); opacity:0; transform:translateY(12px);
  pointer-events:none; transition:all .25s ease; z-index:99;
}
.toast.show{ opacity:1; transform:translateY(0) }

/* Animations */
@keyframes aurora{ 0%{background-position:0% 50%} 100%{background-position:100% 50%} }
